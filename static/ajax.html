<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <link rel="shortcut icon" type="image/ico" href="http://www.datatables.net/media/images/favicon.ico"/>

    <title>DataTables example</title>
    <style type="text/css" title="currentStyle">
        @import "/css/demo_page.css";
        @import "/css/demo_table.css";
    </style>
    <script type="text/javascript" language="javascript" src="/js/jquery.js">
    </script>
    <script type="text/javascript" language="javascript" src="/js/jquery.dataTables.js">
    </script>
    <script type="text/javascript" charset="utf-8">
        var oTable = null;

        $(document).ready(function () {
            /*var oTable = $('#example').dataTable({
                "bProcessing": true,
                //"sAjaxSource": "/arrays.txt"
                "sAjaxSource": "/admin"
            });*/

            $('#add_new').click(function(){
                var t = oTable.fnSettings().aoColumns;
                var a = [];
                for(var i in t){
                    a.push( 'new '+t[i].sTitle );
                    //console.log(t[i].sTitle);

                    //oTable.fnDeleteRow(i);
                }

                oTable.fnClearTable(false);

                // добавляю поле для добавления
                oTable.fnAddData(a);
            });

            $('#show_all').click(function(){
                var list_table = $('<table cellpadding="0" cellspacing="0" border="0" class="display"></table>');
                $('#list').html('');
                $('#list').append(list_table);

                oTable = list_table.dataTable({
                    "aaData": [
                        /* Reduced data set */
                        [ "Trident", "Internet Explorer 4.0", "Win 95+", 4, "X" ],
                        [ "Trident", "Internet Explorer 5.0", "Win 95+", 5, "C" ],
                        [ "Trident", "Internet Explorer 5.5", "Win 95+", 5.5, "A" ],
                        [ "Trident", "Internet Explorer 6.0", "Win 98+", 6, "A" ],
                        [ "Trident", "Internet Explorer 7.0", "Win XP SP2+", 7, "A" ],
                        [ "Gecko", "Firefox 1.5", "Win 98+ / OSX.2+", 1.8, "A" ],
                        [ "Gecko", "Firefox 2", "Win 98+ / OSX.2+", 1.8, "A" ],
                        [ "Gecko", "Firefox 3", "Win 2k+ / OSX.3+", 1.9, "A" ],
                        [ "Webkit", "Safari 1.2", "OSX.3", 125.5, "A" ],
                        [ "Webkit", "Safari 1.3", "OSX.3", 312.8, "A" ],
                        [ "Webkit", "Safari 2.0", "OSX.4+", 419.3, "A" ],
                        [ "Webkit", "Safari 3.0", "OSX.4+", 522.1, "A" ]
                    ],
                    "aoColumns": [
                        { "sTitle": "Engine" },
                        { "sTitle": "Browser" },
                        { "sTitle": "Platform" },
                        { "sTitle": "Version", "sClass": "center" },
                        { "sTitle": "Grade", "sClass": "center" }
                    ],
                    "fnDrawCallback": function () {
                        //console.log($(this).dataTable());

                        var table = $(this);

                        $('th', table).click(function(){
                            // анселекчю все активные эдиты
                            $('th', table).blur();
                        });

                        table.find('td').dblclick(function(){
                            var pos = oTable.fnGetPosition( this );
                            var td = $(this);

                            if($('input', td).length) return;

                            var text = td.html();
                            var edit = $('<input type="text" class="editField">')
                                    .val(text)
                                    .focusout(function(){
                                        td.html(edit.val());
                                        if(text!=edit.val()){
                                            td.closest('tr').attr('changed', true);

                                            // обновляю значение в таблице, т.к. поиск не будет находить измененные поля

                                            oTable.fnUpdate( edit.val(), pos[0], pos[1]);
                                        }
                                    })
                                    .keypress(function(evt){
                                        //console.log( evt.charCode );
                                        if(13==evt.charCode){ // enter key
                                            edit.blur();
                                        }
                                        //console.log(arguments);
                                    })
                                    .keyup(function(evt) {
                                        if (evt.keyCode == 27) { // esc key
                                            td.html(text);
                                        }
                                    });

                            td.html('');
                            td.append(edit);
                            edit.focus();
                        });
                    }
                });
            });

            $('#show_all').click();
        });
    </script>
</head>
<body>
<div id="container">
    <h1>Админ панель</h1>

    <h3 id="add_new">New</h3>
    <h3 id="show_all">All</h3>

    <!--div id="dynamic">
        <table cellpadding="0" cellspacing="0" border="0" class="display" id="example">
            <thead>
            <tr>
                <th>Rendering engine</th>
                <th>Browser</th>
                <th>Platform(s)</th>
                <th>Engine version</th>
                <th>CSS grade</th>
            </tr>
            </thead>
            <tbody>

            </tbody>
            <tfoot>
            <tr>
                <th>Rendering engine</th>
                <th>Browser</th>
                <th>Platform(s)</th>
                <th>Engine version</th>
                <th>CSS grade</th>
            </tr>
            </tfoot>
        </table>
    </div>
    <div class="spacer">
    </div-->
</div>
<div id="list"></div>
</body>
</html>